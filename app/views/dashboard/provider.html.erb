<div class="dashboard-sidebar">
  <div class="sidebar-stats">
    <div class="stat-card">
      <div class="stat-label">My Patients</div>
      <div class="stat-value"><%= @patients.count %></div>
    </div>
    
    <div class="stat-card">
      <div class="stat-label">Urgent (ESI 1-2)</div>
      <div class="stat-value"><%= @patients.where(esi_level: [1, 2]).count %></div>
    </div>
    
    <div class="stat-card">
      <div class="stat-label">Ready for Discharge</div>
      <div class="stat-value">0</div>
    </div>
  </div>
</div>

<div class="dashboard-main">
  <h2>Provider Patients</h2>
  
  <% if @patients.empty? %>
    <div class="empty-state">
      <p>No patients currently assigned to providers</p>
    </div>
  <% else %>
    <div class="patient-table">
      <table>
        <thead>
          <tr>
            <th>Patient</th>
            <th>Care Pathway</th>
            <th>Provider</th>
            <th>ESI</th>
            <th>Time in Care</th>
            <th>Chief Complaint</th>
            <th>Location</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @patients.each do |patient| %>
            <tr data-patient-id="<%= patient.id %>">
              <td>
                <%= link_to patient_path(patient), data: { turbo_frame: "patient_modal" } do %>
                  <div><strong><%= patient.full_name %></strong></div>
                  <div style="font-size: 12px; color: #586069;"><%= patient.age %>Y â€¢ MRN: <%= patient.mrn %></div>
                <% end %>
              </td>
              <td>
                <div class="care-pathway-bar">
                  <%= link_to patient_care_pathways_path(patient, referrer: 'provider'), 
                              class: "btn-action" do %>
                    <%= patient.active_care_pathway&.progress_percentage || 0 %>%
                  <% end %>
                </div>
              </td>
              <td><%= patient.provider %></td>
              <td>
                <span class="esi-badge esi-<%= patient.esi_level %>">
                  ESI <%= patient.esi_level %>
                </span>
              </td>
              <td><%= patient.wait_time_minutes %>m</td>
              <td><%= patient.chief_complaint %></td>
              <td><%= patient.location %></td>
              <td>
                <div class="action-buttons">
                  <button class="btn-action" data-patient-id="<%= patient.id %>">Chart</button>
                  <button class="btn-action" data-patient-id="<%= patient.id %>">Orders</button>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
</div>

<turbo-frame id="patient_modal"></turbo-frame>